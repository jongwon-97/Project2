<!DOCTYPE html >
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>기업 회원가입</title>
  <link rel="stylesheet" href="/css/signup/bSignup2.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>

  <link rel="stylesheet" href="/css/member/bSignup2.css">

</head>
<body>

<!-- 기업 정보 섹션 -->
<div class="signup-container">
  <h1>기업 회원가입</h1>

  <!-- 기업 정보 섹션 -->
  <fieldset class="company-info-section">
    <legend>기업 정보</legend>
    <form action="/bSignup" method="get">
      <div class="form-group">
        <label for="companyName">회사명</label>
        <input type="text" id="companyName" name="companyName" th:value="${companyInfo.companyName}" readonly>
      </div>
      <div class="form-group">
        <label for="companyEmail">대표 이메일</label>
        <input type="email" id="companyEmail" name="companyEmail" th:value="${companyInfo.companyEmail}" readonly>
      </div>
      <div class="form-group">
        <label for="companyPhone">대표 전화번호</label>
        <input type="tel" id="companyPhone" name="companyPhone" th:value="${companyInfo.companyPhone}" readonly>
      </div>
      <div class="form-group">
        <label for="companyPostcode">우편번호</label>
        <input type="text" id="companyPostcode" name="companyPostcode" th:value="${companyInfo.companyPostcode}" readonly>
      </div>
      <div class="form-group">
        <label for="companyAddress">대표 주소</label>
        <input type="text" id="companyAddress" name="companyAddress" th:value="${companyInfo.companyAddress}" readonly>
      </div>
      <div class="form-group">
        <label for="companyLogo">회사 로고</label>
        <div class="image-preview">
          <img th:src="${companyInfo.companyLogoUrl}" alt="로고 미리보기">
        </div>
      </div>
    </form>
  </fieldset>

  <!-- 기업 회원 정보 섹션 -->
  <fieldset class="member-info-section">
    <legend>기업 회원 정보</legend>
    <form action="/bSignup2" method="post" enctype="multipart/form-data">
      <div class="form-group">
        <label for="memberId">아이디</label>
        <div class="input-group">
          <input type="text" id="memberId" name="memberId" placeholder="아이디를 입력하세요" readonly>
          <button type="button" class="id-check-button" onclick="openIdCheckPopup()">중복 확인</button>
        </div>
      </div>
      <div class="form-group">
        <label for="memberPw">비밀번호</label>
        <input type="password" id="memberPw" name="memberPw" placeholder="비밀번호를 입력하세요">
        <div class="error-message" id="passwordError"></div>
      </div>
      <div class="form-group">
        <label for="confirmPw">비밀번호 확인</label>
        <input type="password" id="confirmPw" name="confirmPw" placeholder="비밀번호를 다시 입력하세요">
        <div class="error-message" id="confirmPasswordError"></div>
      </div>
      <div class="form-group">
        <label for="memberName">이름</label>
        <input type="text" id="memberName" name="memberName" placeholder="이름을 입력하세요">
        <div class="error-message" id="nameError"></div>
      </div>
      <div class="form-group">
        <label for="memberEmail">이메일</label>
        <input type="email" id="memberEmail" name="memberEmail" placeholder="이메일을 입력하세요">
        <div class="error-message" id="emailError"></div>
      </div>
      <div class="form-group">
        <label for="memberPhone">전화번호</label>
        <input type="tel" id="memberPhone" name="memberPhone" placeholder="예(010-xxxx-xxxx)">
        <div class="error-message" id="phoneError"></div>
      </div>
      <div class="form-group">
        <label for="memberBirth">생년월일</label>
        <input type="date" id="memberBirth" name="memberBirth">
        <div class="error-message" id="birthError"></div>
      </div>
      <div class="form-group">
        <label>성별</label>
        <div class="gender-options">
          <button type="button" class="gender-button" id="maleButton">남성</button>
          <button type="button" class="gender-button" id="femaleButton">여성</button>
          <input type="hidden" id="memberGender" name="memberGender">
        </div>
        <div class="error-message" id="genderError"></div>
      </div>
      <div class="form-group">
        <label for="memberRank">직급</label>
        <input type="text" id="memberRank" name="memberRank" placeholder="직급을 입력하세요">
        <div class="error-message" id="rankError"></div>
      </div>
      <div class="form-group">
        <label for="memberDepartment">부서</label>
        <input type="text" id="memberDepartment" name="memberDepartment" placeholder="부서를 입력하세요">
        <div class="error-message" id="departmentError"></div>
      </div>
      <div class="form-group">
        <label for="memberNum">사번</label>
        <input type="text" id="memberNum" name="memberNum" placeholder="사번을 입력하세요">
        <div class="error-message" id="numError"></div>
      </div>
      <div class="form-group">
        <label for="memberPostcode">우편번호</label>
        <div class="address-container">
          <input type="text" id="memberPostcode" name="memberPostcode" placeholder="우편번호" readonly>
          <button type="button" id="searchPostcodeBtn">우편번호 찾기</button>
        </div>
      </div>
      <div class="form-group">
        <label for="memberAddress">주소</label>
        <input type="text" id="memberAddress" name="memberAddress" placeholder="주소" readonly>
      </div>
      <div class="form-group">
        <label for="memberDAddress">상세 주소</label>
        <input type="text" id="memberDAddress" name="memberDAddress" placeholder="상세 주소">
      </div>
      <div class="form-group">
        <label for="memberImg">프로필 이미지</label>
        <div class="file-upload-container">
          <div class="image-preview">
            <img src="images/noIdp.png" alt="기본 이미지" id="previewImg">
          </div>
          <input type="file" id="memberImg" name="memberImg" accept="image/*" onchange="previewImage(event)">
          <label for="memberImg" class="custom-file-button">파일 선택</label>
        </div>
      </div>
      <div class="form-group">
        <button type="submit" class="signup-button">가입하기</button>
      </div>
    </form>
  </fieldset>
</div>

<script type="module">
  import { searchAddress } from './js/postcode.js';

  // DOM이 준비된 후 이벤트 설정
  document.addEventListener('DOMContentLoaded', () => {
      const postcodeButton = document.getElementById('searchPostcodeBtn');
      if (postcodeButton) {
          postcodeButton.addEventListener('click', () => {
              searchAddress('memberPostcode', 'memberAddress', 'memberDAddress');
          });
      } else {
          console.error('우편번호 찾기 버튼을 찾을 수 없습니다.');
      }
  });
</script>
<script>
  //아이디 중복 확인 기능
    function openIdCheckPopup() {
        window.open("/idCheck", "idCheck", "width=400,height=300,left=100,top=100");
    }

    function setIdCheckResult(memberId) {
        const idInput = document.getElementById("memberId");
        idInput.value = memberId;
        idInput.readOnly = true; // 수정 불가능하게 설정
    }

  // 이미지 미리보기 기능
    function previewImage(event) {
        const input = event.target;
        const previewImg = document.getElementById('previewImg');

        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = function () {
                previewImg.src = reader.result;
            };
            reader.readAsDataURL(input.files[0]);
        } else {
            previewImg.src = "images/noimage.png"; // 기본 이미지 복원
        }
    }
  document.addEventListener('DOMContentLoaded', () => {
    const maleButton = document.getElementById('maleButton');
    const femaleButton = document.getElementById('femaleButton');
    const genderInput = document.getElementById('memberGender');

    maleButton.addEventListener('click', () => {
        maleButton.classList.add('selected');
        femaleButton.classList.remove('selected');
        genderInput.value = 'M';
    });

    femaleButton.addEventListener('click', () => {
        femaleButton.classList.add('selected');
        maleButton.classList.remove('selected');
        genderInput.value = 'F';
    });
});
</script>
<script src="/js/validation.js" type="module"></script>
<script src="/js/postcode.js" type="module"></script>
</body>
</html>
