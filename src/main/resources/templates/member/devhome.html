<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="/css/member/devhome.css">
  <title>Dev Home</title>

  <script>
    function checkSession() {
      fetch('/session-status', { method: 'GET' })
              .then(response => {
                if (response.ok) {
                  return response.json();
                } else {
                  throw new Error("로그인 상태가 아닙니다.");
                }
              })
              .then(data => {
                document.getElementById('sessionStatus').innerText = `${data.memberName} 님 로그인 중입니다.`;
                document.getElementById('memberRole').innerText = `권한: ${data.memberRole}`;

                const userCard = document.getElementById('userCard');
                userCard.innerHTML = `
            <h3>${data.memberName} 님</h3>
            <p>${data.memberEmail}</p>
            <p>Role: ${data.memberRole}</p>
          `;
              })
              .catch(() => {
                document.getElementById('sessionStatus').innerText = "로그인 정보가 없습니다.";
                document.getElementById('memberRole').innerText = "권한 정보를 확인할 수 없습니다.";

                const userCard = document.getElementById('userCard');
                userCard.innerHTML = `
            <h3>로그인 정보 없음</h3>
            <p>정보를 불러올 수 없습니다.</p>
          `;
              });
    }

    window.onload = function() {
      checkSession();
    };

    function logout() {
      fetch('/logout', { method: 'POST' })
              .then(() => {
                window.location.href = '/';
              });
    }
  </script>
</head>
<body>
<h1>Dev Home</h1>
<p id="sessionStatus">세션 정보를 불러오는 중...</p>
<p id="memberRole">권한 정보를 불러오는 중...</p>

<!-- 상단 네비게이션 바 -->
<div class="navbar">
  <a href="/dev/home">Home</a>
  <a href="/dev/companyList">회사 목록 보기</a>
  <a href="/dev/board/eventList">이벤트 목록 보기</a>
  <a href="/dev/board/notificationList">공지사항 목록</a>
  <a href="/dev/board/qnaList">Q&A</a>
</div>

<!-- 대시보드 내용 -->
<div class="container">
  <!-- 사용자 정보 카드 -->
  <div class="card" id="userCard">
    <!-- JavaScript에서 데이터로 채워짐 -->
  </div>

  <!-- 다른 카드 -->
  <div class="card">
    <h3>답변대기중인 Q&A</h3>
  </div>
  <div class="card">
    <h3>행사 모집현황</h3>
  </div>
  <div class="card">
    <h3>공지사항</h3>
  </div>
</div>

<!-- 로그아웃 버튼 -->
<button onclick="logout()">로그아웃</button>

</body>
</html>
