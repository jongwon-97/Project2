<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>개인 회원가입</title>

    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="/css/signup/pSignup.css">
    <script src="/js/validation.js"></script>
</head>
<body>
<div class="signup-container">
    <h1>개인 회원가입</h1>
    <form action="/pSignup" method="post" enctype="multipart/form-data" class="signup-form">
        <!-- 아이디 및 비밀번호 섹션 -->
        <fieldset>
            <legend>아이디 및 비밀번호 설정</legend>
            <div class="form-group">
                <label for="memberId">아이디</label>
                <div class="input-group">
                    <input type="text" id="memberId" name="memberId" placeholder="아이디를 입력하세요" readonly>
                    <button type="button" class="id-check-button" onclick="openIdCheckPopup()">중복 확인</button>
                </div>
            </div>
            <div class="form-group">
                <label for="memberPw">비밀번호</label>
                <input type="password" id="memberPw" name="memberPw" placeholder="비밀번호를 입력하세요">
                <div class="error-message" id="passwordError"></div>
            </div>
            <div class="form-group">
                <label for="confirmPw">비밀번호 확인</label>
                <input type="password" id="confirmPw" name="confirmPw" placeholder="비밀번호를 다시 입력하세요">
                <div class="error-message" id="confirmPasswordError"></div>
            </div>
        </fieldset>

        <!-- 개인정보 섹션 -->
        <fieldset>
            <legend>개인정보 입력</legend>
            <div class="form-group">
                <label for="memberName">이름</label>
                <input type="text" id="memberName" name="memberName" placeholder="이름을 입력하세요">
                <div class="error-message" id="nameError"></div>
            </div>
            <div class="form-group">
                <label for="memberEmail">이메일</label>
                <input type="email" id="memberEmail" name="memberEmail" placeholder="이메일을 입력하세요">
                <div class="error-message" id="emailError"></div>
            </div>
            <div class="form-group">
                <label for="memberBirth">생년월일</label>
                <input type="date" id="memberBirth" name="memberBirth">
                <div class="error-message" id="birthError"></div>
            </div>
            <div class="form-group">
                <label>성별</label>
                <div class="gender-options">
                    <button type="button" class="gender-button" data-gender="M">남성</button>
                    <button type="button" class="gender-button" data-gender="F">여성</button>
                </div>
                <input type="hidden" id="memberGender" name="memberGender">
            </div>
            <div class="error-message" id="genderError"></div>
            <div class="form-group">
                <label for="memberPhone">전화번호</label>
                <input type="tel" id="memberPhone" name="memberPhone" placeholder="예(010-xxxx-xxxx)">
                <div class="error-message" id="phoneError"></div>
            </div>
        </fieldset>

        <!-- 주소 섹션 -->
        <fieldset>
            <legend>주소 입력</legend>
            <div class="form-group">
                <label for="memberPostcode">우편번호</label>
                <div class="input-group">
                    <input type="text" id="memberPostcode" name="memberPostcode" placeholder="우편번호" readonly>
                    <button type="button" id="searchPostcodeBtn">우편번호 찾기</button>
                </div>
                <div class="error-message" id="postcodeError"></div>
            </div>
            <div class="form-group">
                <label for="memberAddress">주소</label>
                <input type="text" id="memberAddress" name="memberAddress" placeholder="주소">
            </div>
            <div class="form-group">
                <label for="memberDAddress">상세 주소</label>
                <input type="text" id="memberDAddress" name="memberDAddress" placeholder="상세 주소">
            </div>
        </fieldset>

        <!-- 프로필 이미지 -->
        <fieldset>
            <legend>프로필 이미지</legend>
            <div class="image-upload">
                <div class="image-preview" id="imagePreview">
                    <img src="images/noIdp.png" alt="기본 이미지" id="previewImg">
                </div>
                <input type="file" id="memberImg" name="memberImg" accept="image/*" onchange="previewImage(event)">
                <label for="memberImg" class="custom-file-button">파일 선택</label>
            </div>
        </fieldset>

        <!-- 가입 버튼 -->
        <button type="submit" class="signup-button">가입하기</button>
    </form>
</div>

<script>
    // 팝업 창에서 호출할 함수
    function setIdCheckResult(memberId) {
        const memberIdInput = document.getElementById("memberId");
        memberIdInput.value = memberId;
    }

    // 아이디 중복 확인 팝업 열기
    function openIdCheckPopup() {
        window.open("/idCheck", "idCheck", "width=400,height=300,left=100,top=100");
    }

    // 성별 선택 버튼 기능
    document.querySelectorAll('.gender-button').forEach(button => {
        button.addEventListener('click', () => {
            document.querySelectorAll('.gender-button').forEach(btn => btn.classList.remove('selected'));
            button.classList.add('selected');
            document.getElementById('memberGender').value = button.getAttribute('data-gender');
        });
    });

    // 이미지 미리보기
    function previewImage(event) {
        const input = event.target;
        const previewImg = document.getElementById('previewImg');
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = () => previewImg.src = reader.result;
            reader.readAsDataURL(input.files[0]);
        } else {
            previewImg.src = "images/noIdp.png";
        }
    }
    // 우편번호 찾기
    document.getElementById('searchPostcodeBtn').addEventListener('click', function () {
        new daum.Postcode({
            oncomplete: function (data) {
                document.getElementById('memberPostcode').value = data.zonecode;
                document.getElementById('memberAddress').value = data.address;
            }
        }).open();
    });
</script>
</body>
</html>